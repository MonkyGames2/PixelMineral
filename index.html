<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Juego de Miner√≠a ‚Äì Preview</title>
<style>
body{background:#1b1b1b;color:#fff;font-family:monospace;text-align:center}
h2{font-size:32px}
canvas{background:#2a2a2a;border:4px solid #777;margin-top:10px;image-rendering:pixelated}
button{margin:6px;padding:10px 18px;font-family:monospace;font-size:18px;background:#444;color:#fff;border:2px solid #999;cursor:pointer}
button:hover{background:#666}
</style>
</head>
<body>

<h2>‚õèÔ∏è Juego de Miner√≠a ‚Äì Preview</h2>

<canvas id="game" width="800" height="600"></canvas><br>

<button id="mineBtn">‚õèÔ∏è MINAR</button>
<button onclick="togglePickShop()">üõí TIENDA PICOS</button>
<button onclick="toggleEnchantShop()">‚ú® ENCANTAMIENTOS</button>
<button onclick="toggleRebirthShop()">‚ôªÔ∏è REBIRTH</button>

<script>
/* ======================================================
   CONFIG GENERAL
====================================================== */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
ctx.font="20px monospace";

/* ======================================================
   AUDIO
====================================================== */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
function beep(f,d=0.05){
 const o=audioCtx.createOscillator(),g=audioCtx.createGain();
 o.type="square";o.frequency.value=f;
 o.connect(g);g.connect(audioCtx.destination);
 g.gain.value=0.04;o.start();o.stop(audioCtx.currentTime+d);
}
function playBuy(){beep(900,0.1);}

/* ======================================================
   STATS JUGADOR
====================================================== */
let plata=0;
let rebirths=0;
let moneyMult=1;
let blockDurMult=1;

/* ======================================================
   UI FLAGS
====================================================== */
let showPickShop=false;
let showEnchantShop=false;
let showRebirthShop=false;
let hoverRebirth=false;

/* ======================================================
   SISTEMA DE MUTACIONES
====================================================== */
const mutations=[
 {name:"Normal",mult:1,chance:88,color:"#fff"},
 {name:"Shiny",mult:2,chance:8,color:"#ffff66"},
 {name:"Radiant",mult:3,chance:3,color:"#66ffff"},
 {name:"Void",mult:5,chance:1,color:"#cc00ff"}
];

function rollMutation(){
 let r=Math.random()*100;
 let acc=0;
 for(let m of mutations){
  acc+=m.chance;
  if(r<acc) return m;
 }
 return mutations[0];
}

/* ======================================================
   MINERALES (NO SE ELIMINA NADA)
====================================================== */
const minerals=[
 {name:'Tierra',value:1,weight:100,color:'#8b5a2b',hp:50,stars:1},
 {name:'Piedra',value:2,weight:90,color:'#777',hp:100,stars:1},
 {name:'Grava',value:3,weight:85,color:'#999',hp:120,stars:1},
 {name:'Carb√≥n',value:5,weight:80,color:'#111',hp:180,stars:2},
 {name:'Cobre',value:8,weight:70,color:'#c46b32',hp:220,stars:2},
 {name:'Esta√±o',value:9,weight:65,color:'#bbb',hp:230,stars:2},
 {name:'Hierro',value:10,weight:60,color:'#aaa',hp:240,stars:3},
 {name:'N√≠quel',value:12,weight:55,color:'#aaa',hp:260,stars:3},
 {name:'Plata',value:15,weight:45,color:'#ddd',hp:340,stars:3},
 {name:'Oro',value:20,weight:35,color:'#ffd700',hp:380,stars:4},
 {name:'Platino',value:25,weight:25,color:'#e5e4e2',hp:420,stars:4},
 {name:'Esmeralda',value:35,weight:18,color:'#00cc66',hp:500,stars:4},
 {name:'Zafiro',value:40,weight:15,color:'#0033ff',hp:520,stars:4},
 {name:'Rub√≠',value:45,weight:14,color:'#cc0000',hp:540,stars:5},
 {name:'Amatista',value:50,weight:12,color:'#9933ff',hp:560,stars:5},
 {name:'Diamante',value:60,weight:8,color:'#0ff',hp:600,stars:5},
 {name:'Obsidiana',value:70,weight:6,color:'#550055',hp:720,stars:5},
 {name:'Netherite',value:80,weight:5,color:'#3a0f0f',hp:820,stars:5},
 {name:'Mithril',value:120,weight:3,color:'#66ffff',hp:1100,stars:6},
 {name:'Adamantita',value:140,weight:2,color:'#00ffaa',hp:1250,stars:6},
 {name:'Oricalco',value:160,weight:2,color:'#ff8800',hp:1350,stars:6},
 {name:'Aetherium',value:180,weight:1,color:'#ccccff',hp:1500,stars:6},
 {name:'Voidstone',value:200,weight:1,color:'#111111',hp:1600,stars:6},
 {name:'Luminium',value:240,weight:1,color:'#ffffaa',hp:1750,stars:6},
 {name:'Cryonita',value:260,weight:1,color:'#aaffff',hp:1850,stars:6},
 {name:'Solarite',value:280,weight:1,color:'#ffaa00',hp:2000,stars:6},
 {name:'Umbrium',value:300,weight:1,color:'#000',hp:2200,stars:6},
 {name:'Celestita',value:340,weight:1,color:'#99ccff',hp:2500,stars:7},
 {name:'Astralium',value:380,weight:1,color:'#cc99ff',hp:2800,stars:7},
 {name:'Draconium',value:420,weight:1,color:'#ff3333',hp:3200,stars:7},
 {name:'Eternium',value:500,weight:1,color:'#fff',hp:3600,stars:7},
 {name:'Chronorock',value:650,weight:1,color:'#ccc',hp:4200,stars:8},
 {name:'Omnistone',value:900,weight:1,color:'#ff00ff',hp:5000,stars:8}
];

/* ======================================================
   PICOS (TODOS)
====================================================== */
const picks=[
 {name:'Pico de Madera',cost:0,base:50,damage:5},
 {name:'Pico de Piedra',cost:50,base:150,damage:8},
 {name:'Pico de Cobre',cost:150,base:330,damage:12},
 {name:'Pico de Hierro',cost:400,base:450,damage:18},
 {name:'Pico de Oro',cost:800,base:600,damage:25},
 {name:'Pico de Diamante',cost:1600,base:1350,damage:40},
 {name:'Pico Legendario',cost:32000,base:4150,damage:120},
 {name:'Pico Divino',cost:120000,base:8000,damage:260},
 {name:'Pico C√≥smico',cost:500000,base:15000,damage:520},
 {name:'Pico del Vac√≠o',cost:2000000,base:30000,damage:1200}
];

/* ======================================================
   ESTADO ACTUAL
====================================================== */
let pick={...picks[0],dur:picks[0].base,ench:{ef:0,dur:0,for:0}};
let currentBlock=null;
let blockHP=0;

/* ======================================================
   GENERAR BLOQUE
====================================================== */
function randomBlock(){
 let total=minerals.reduce((a,b)=>a+b.weight,0);
 let r=Math.random()*total;
 for(let m of minerals){
  if(r<m.weight){
   const mut=rollMutation();
   const hp=Math.floor(m.hp*blockDurMult);
   return {...m,mutation:mut,hp};
  }
  r-=m.weight;
 }
}

/* ======================================================
   GAMEPLAY
====================================================== */
function mine(){
 if(pick.dur<=0)return;
 pick.dur--;
 blockHP-=pick.damage;
 beep(400);
 if(blockHP<=0)breakBlock();
 draw();
}

function breakBlock(){
 const starMult=1+(currentBlock.stars*0.15);
 const gain=Math.floor(
  currentBlock.value *
  starMult *
  currentBlock.mutation.mult *
  moneyMult
 );
 plata+=gain;
 currentBlock=randomBlock();
 blockHP=currentBlock.hp;
}

/* ======================================================
   REBIRTH
====================================================== */
function doRebirth(){
 if(plata<5000)return;
 playBuy();
 rebirths++;
 plata=0;
 moneyMult*=1.25;
 blockDurMult*=1.08;
 pick={...picks[0],dur:picks[0].base,ench:{ef:0,dur:0,for:0}};
 currentBlock=randomBlock();
 blockHP=currentBlock.hp;
}

/* ======================================================
   UI
====================================================== */
function togglePickShop(){showPickShop=!showPickShop;showEnchantShop=false;showRebirthShop=false}
function toggleEnchantShop(){showEnchantShop=!showEnchantShop;showPickShop=false;showRebirthShop=false}
function toggleRebirthShop(){showRebirthShop=!showRebirthShop;showPickShop=false;showEnchantShop=false}

function draw(){
 ctx.clearRect(0,0,800,600);

 ctx.fillStyle="#fff";
 ctx.fillText("Plata: "+plata,20,30);
 ctx.fillText("Rebirths: "+rebirths,20,55);
 ctx.fillText("Money x"+moneyMult.toFixed(2),20,80);

 ctx.fillStyle=currentBlock.color;
 ctx.fillRect(330,220,140,140);

 ctx.fillStyle="#f00";
 ctx.fillRect(330,200,140,10);
 ctx.fillStyle="#0f0";
 ctx.fillRect(330,200,140*(blockHP/currentBlock.hp),10);

 ctx.fillStyle="#fff";
 ctx.fillText(currentBlock.name,300,390);
 ctx.fillStyle=currentBlock.mutation.color;
 ctx.fillText(currentBlock.mutation.name,300,415);
 ctx.fillStyle="#fff";
 ctx.fillText("‚òÖ".repeat(currentBlock.stars),300,440);

 if(showRebirthShop){
  ctx.fillText("REBIRTH ($5000)",20,130);
  if(hoverRebirth){
   ctx.fillStyle="#0088ff";
   ctx.fillRect(15,150,360,120);
  }
  ctx.fillStyle="#fff";
  ctx.fillText("+25% dinero",20,190);
  ctx.fillText("+8% durabilidad bloques",20,220);
  ctx.fillText("CLICK PARA RENACER",20,250);
 }
}

canvas.addEventListener("mousemove",e=>{
 hoverRebirth=showRebirthShop && e.offsetX>15 && e.offsetX<375 && e.offsetY>150 && e.offsetY<270;
 draw();
});

canvas.addEventListener("click",()=>{
 if(showRebirthShop && hoverRebirth) doRebirth();
});

let mining=null;
document.getElementById("mineBtn").onmousedown=()=>mining=setInterval(mine,120);
document.getElementById("mineBtn").onmouseup=
document.getElementById("mineBtn").onmouseleave=()=>clearInterval(mining);
document.getElementById("mineBtn").onclick=()=>mine();

/* ======================================================
   INIT
====================================================== */
currentBlock=randomBlock();
blockHP=currentBlock.hp;
draw();
</script>

</body>
</html>
